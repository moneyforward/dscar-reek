version: 2.1

description: Delta Reek reports

orbs:
  dscar: naokikimura/dscar@0.8.1

executors:
  default:
    description: Default Reek execution environment
    parameters:
      docker-image:
        description: Specify the image used to execute Reek
        type: string
        default: circleci/ruby:latest-node
      project-git_url:
        description: "Please set << pipeline.project.git_url >>"
        type: string
      git-base_revision:
        description: "Please set << pipeline.git-base_revision >>"
        type: string
      git-revision:
        description: "Please set << pipeline.git-revision >>"
        type: string
    docker:
      - image: << parameters.docker-image >>
    environment:
      CIRCLE_COMPARE_URL: << parameters.project-git_url >>/compare/<< parameters.git-base_revision >>..<< parameters.git-revision >>
